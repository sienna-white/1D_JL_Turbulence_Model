<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - advance_variables.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Mon, 03 Mar 2025 22:05:19
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Physical parameters </span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>z0 &#61; 0.01         # Bottom roughness &#91;m&#93;</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>zb &#61; 10*z0        # Bottom height &#91;m&#93;</span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>g  &#61; 9.81         # Gravity &#91;m/s^2&#93;</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>C_D &#61; 0.0025      # Friction coefficient </span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>SMALL &#61; 1e-6      # Noise floor for turbulence quantities &#91;m/s?&#93;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>kappa &#61; 0.4       # Von Karman constant</span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>nu &#61; 1e-6         # Kinematic viscosity &#91;m^2/s&#93;</span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>rho0 &#61; 1000       # Water density &#91;kg/m^3&#93;</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>alpha  &#61;  2.1e-4      # Thermal expansivity, set to zero for passive scalar case</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Mellor-Yamada closure parameters. All dimensionless --&gt; no need to change  </span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>A1&#61;0.92 # &#91;-&#93;</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>A2&#61;0.74 # &#91;-&#93;</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>B1&#61;16.6 # &#91;-&#93;</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>B2&#61;10.1 # &#91;-&#93;</span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>C1&#61;0.08 # &#91;-&#93;</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>E1&#61;1.8  # &#91;-&#93;</span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>E2&#61;1.33 # &#91;-&#93;</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>E3&#61;0.25 # &#91;-&#93;</span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Sq&#61;0.2  # &#91;-&#93;</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              1 &#40;0 &#37;&#41;
              samples spent in TDMA
              <br />
              
              1 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from advance_velocity
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L78'>line 78</a>
              <br />
            </div>
            
            <span class='code'>function TDMA&#40;a::Vector&#123;&lt;:Real&#125;, b::Vector&#123;&lt;:Real&#125;, c::Vector&#123;&lt;:Real&#125;, d::Vector&#123;&lt;:Real&#125;, N::Real&#41;</span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Tri Diagonal Matrix Algorithm&#40;a.k.a Thomas algorithm&#41; solver</span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # a &#61; Lower Diag, b &#61; Main Diag, c &#61; Upper Diag, d &#61; solution vector</span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-966786c0df099c339b1d2cd23038fc8397e21825.html#L631'>zeros</a>
              <br />
            </div>
            <span class='code'>    x &#61; zeros&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 2:N</span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        b&#91;i&#93; &#61; b&#91;i&#93; - a&#91;i&#93;/b&#91;i-1&#93;*c&#91;i-1&#93;</span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        d&#91;i&#93; &#61; d&#91;i&#93; - a&#91;i&#93;/b&#91;i-1&#93;*d&#91;i-1&#93;</span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    x&#91;N&#93; &#61; d&#91;N&#93;/b&#91;N&#93;</span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in N-1:-1:1</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        x&#91;i&#93; &#61; &#40;1/b&#91;i&#93;&#41;*&#40;d&#91;i&#93; - c&#91;i&#93;*x&#91;i&#43;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return x</span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'> </span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              4 &#40;1 &#37;&#41;
              samples spent in initialize_abcd
              <br />
              
              2 &#40;50 &#37;&#41; &#40;incl.&#41;
              when called from advance_velocity
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L57'>line 57</a>
              <br />
              
              1 &#40;25 &#37;&#41; &#40;incl.&#41;
              when called from advance_Q2
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L189'>line 189</a>
              <br />
              
              1 &#40;25 &#37;&#41; &#40;incl.&#41;
              when called from advance_algae
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L89'>line 89</a>
              <br />
            </div>
            
            <span class='code'>function initialize_abcd&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-966786c0df099c339b1d2cd23038fc8397e21825.html#L631'>zeros</a>
              <br />
            </div>
            <span class='code'>    a &#61; zeros&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-966786c0df099c339b1d2cd23038fc8397e21825.html#L631'>zeros</a>
              <br />
            </div>
            <span class='code'>    b &#61; zeros&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    c &#61; zeros&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-966786c0df099c339b1d2cd23038fc8397e21825.html#L631'>zeros</a>
              <br />
            </div>
            <span class='code'>    d &#61; zeros&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return a, b, c, d</span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># &#40;U_past, Nut_past, pressure, beta, 0&#41;</span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              16 &#40;4 &#37;&#41;
              samples spent in advance_velocity
              <br />
              11 &#40;69 &#37;&#41; &#40;ex.&#41;,
              16 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from run_my_model
              <a href='run_model.jl-1578659b3b52a77292ed1339762b5233869a2b57.html#L232'>line 232</a>
              <br />
            </div>
            
            <span class='code'>function advance_velocity&#40;past_var::Dict, Px::Real, discretization::Dict, W&#61;0::Real&#41;</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    U_past &#61; past_var&#91;&quot;U&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    nu_past &#61; past_var&#91;&quot;Nu&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L55'>
          <td class='lineno'>55</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N &#61; length&#40;U_past&#41;</span>
          </td>
        </tr>
        <tr id='L56'>
          <td class='lineno'>56</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L57'>
          <td class='lineno'>57</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L41'>initialize_abcd</a>
              <br />
            </div>
            <span class='code'>    aU, bU, cU, dU &#61; initialize_abcd&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L58'>
          <td class='lineno'>58</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L59'>
          <td class='lineno'>59</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    beta &#61; discretization&#91;&quot;beta&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L60'>
          <td class='lineno'>60</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dt &#61; discretization&#91;&quot;dt&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L61'>
          <td class='lineno'>61</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dz &#61; discretization&#91;&quot;dz&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L62'>
          <td class='lineno'>62</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L63'>
          <td class='lineno'>63</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 2:&#40;N-1&#41;</span>
          </td>
        </tr>
        <tr id='L64'>
          <td class='lineno'>64</td>
          <td class='tracecount excl'>3 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>3 &#40;1 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>        aU&#91;i&#93; &#61; -beta/2*&#40;nu_past&#91;i&#93; &#43; nu_past&#91;i-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L65'>
          <td class='lineno'>65</td>
          <td class='tracecount excl'>2 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>2 &#40;1 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>        bU&#91;i&#93; &#61; 1 &#43; beta/2*&#40;nu_past&#91;i&#43;1&#93; &#43; 2*nu_past&#91;i&#93; &#43; nu_past&#91;i-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L66'>
          <td class='lineno'>66</td>
          <td class='tracecount excl'>4 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>4 &#40;1 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>        cU&#91;i&#93; &#61; -beta/2 * &#40;nu_past&#91;i&#93; &#43; nu_past&#91;i&#43;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L67'>
          <td class='lineno'>67</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>3 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;50 &#37;&#41;
              samples spent calling
              <a href='float.jl-bdd47079aed1ee7b825b68a8e40cf0482ccd53e5.html#L410'>-</a>
              <br />
              1 &#40;50 &#37;&#41;
              samples spent calling
              <a href='promotion.jl-19c22fcf9fd2f358d79c65c2fb3a734a4f85ac2c.html#L423'>*</a>
              <br />
            </div>
            <span class='code'>        dU&#91;i&#93; &#61; U_past&#91;i&#93; - dt*Px #&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L68'>
          <td class='lineno'>68</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L69'>
          <td class='lineno'>69</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L70'>
          <td class='lineno'>70</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bU&#91;1&#93; &#61; 1 &#43; beta/2*&#40;nu_past&#91;2&#93; &#43; nu_past&#91;1&#93; &#43; 2*&#40;&#40;C_D^0.5&#41;/kappa&#41;*nu_past&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L71'>
          <td class='lineno'>71</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cU&#91;1&#93; &#61; -beta/2*&#40;nu_past&#91;2&#93; &#43; nu_past&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L72'>
          <td class='lineno'>72</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dU&#91;1&#93; &#61; U_past&#91;1&#93; - dt*Px # &#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L73'>
          <td class='lineno'>73</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L74'>
          <td class='lineno'>74</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    aU&#91;end&#93; &#61; -beta/2*&#40;nu_past&#91;end&#93; &#43; nu_past&#91;end-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L75'>
          <td class='lineno'>75</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bU&#91;end&#93; &#61; 1 &#43; beta/2*&#40;nu_past&#91;end&#93; &#43; nu_past&#91;end-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L76'>
          <td class='lineno'>76</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dU&#91;end&#93; &#61; U_past&#91;end&#93; - dt*Px &#43; W #dz # Px&#91;end&#93;</span>
          </td>
        </tr>
        <tr id='L77'>
          <td class='lineno'>77</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L78'>
          <td class='lineno'>78</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L24'>TDMA</a>
              <br />
            </div>
            <span class='code'>    U &#61; TDMA&#40;aU, bU, cU, dU, N&#41;</span>
          </td>
        </tr>
        <tr id='L79'>
          <td class='lineno'>79</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L80'>
          <td class='lineno'>80</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return U</span>
          </td>
        </tr>
        <tr id='L81'>
          <td class='lineno'>81</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end </span>
          </td>
        </tr>
        <tr id='L82'>
          <td class='lineno'>82</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L83'>
          <td class='lineno'>83</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              30 &#40;8 &#37;&#41;
              samples spent in advance_algae
              <br />
              26 &#40;87 &#37;&#41; &#40;ex.&#41;,
              30 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from run_my_model
              <a href='run_model.jl-1578659b3b52a77292ed1339762b5233869a2b57.html#L256'>line 256</a>
              <br />
            </div>
            
            <span class='code'>function advance_algae&#40;variables, algae, gamma, discretization&#41;</span>
          </td>
        </tr>
        <tr id='L84'>
          <td class='lineno'>84</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N &#61; discretization&#91;&quot;N&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L85'>
          <td class='lineno'>85</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    beta &#61; discretization&#91;&quot;beta&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L86'>
          <td class='lineno'>86</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dt &#61; discretization&#91;&quot;dt&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L87'>
          <td class='lineno'>87</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dz &#61; discretization&#91;&quot;dz&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L88'>
          <td class='lineno'>88</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L89'>
          <td class='lineno'>89</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L41'>initialize_abcd</a>
              <br />
            </div>
            <span class='code'>    aA, bA, cA, dA &#61; initialize_abcd&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L90'>
          <td class='lineno'>90</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L91'>
          <td class='lineno'>91</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ws &#61; algae&#91;&quot;ws&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L92'>
          <td class='lineno'>92</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Kz_past &#61; variables&#91;&quot;Kz&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L93'>
          <td class='lineno'>93</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    A_past &#61; algae&#91;&quot;c&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L94'>
          <td class='lineno'>94</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L95'>
          <td class='lineno'>95</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    wsdtdz &#61; abs&#40;ws*dt&#41;/dz</span>
          </td>
        </tr>
        <tr id='L96'>
          <td class='lineno'>96</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L97'>
          <td class='lineno'>97</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # If settling speed is UPWARD &#40;swimming&#33;&#41;</span>
          </td>
        </tr>
        <tr id='L98'>
          <td class='lineno'>98</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if ws&gt;0</span>
          </td>
        </tr>
        <tr id='L99'>
          <td class='lineno'>99</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for i in 2:&#40;N-1&#41;</span>
          </td>
        </tr>
        <tr id='L100'>
          <td class='lineno'>100</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            aA&#91;i&#93; &#61; -wsdtdz - beta/2 * &#40;Kz_past&#91;i-1&#93; &#43; Kz_past&#91;i&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L101'>
          <td class='lineno'>101</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            bA&#91;i&#93; &#61; 1 &#43; wsdtdz - gamma&#91;i&#93;*dt &#43; beta/2*&#40;Kz_past&#91;i&#43;1&#93; &#43; 2*Kz_past&#91;i&#93; &#43; Kz_past&#91;i-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L102'>
          <td class='lineno'>102</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            cA&#91;i&#93; &#61; -beta/2 * &#40;Kz_past&#91;i&#93; &#43; Kz_past&#91;i&#43;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L103'>
          <td class='lineno'>103</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            dA&#91;i&#93; &#61; A_past&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L104'>
          <td class='lineno'>104</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L105'>
          <td class='lineno'>105</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L106'>
          <td class='lineno'>106</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # Bottom-Boundary: no flux for scalars</span>
          </td>
        </tr>
        <tr id='L107'>
          <td class='lineno'>107</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        bA&#91;1&#93; &#61;  1 - &#40;gamma&#91;1&#93;*dt&#41; &#43; beta/2*&#40;Kz_past&#91;2&#93; &#43; Kz_past&#91;1&#93;&#41; &#43; wsdtdz</span>
          </td>
        </tr>
        <tr id='L108'>
          <td class='lineno'>108</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        cA&#91;1&#93; &#61; -beta/2 * &#40;Kz_past&#91;2&#93; &#43; Kz_past&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L109'>
          <td class='lineno'>109</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        dA&#91;1&#93; &#61;  A_past&#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L110'>
          <td class='lineno'>110</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L111'>
          <td class='lineno'>111</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # Top-Boundary: no flux for scalars</span>
          </td>
        </tr>
        <tr id='L112'>
          <td class='lineno'>112</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        aA&#91;end&#93; &#61; -wsdtdz - beta/2 * &#40;Kz_past&#91;end&#93; &#43; Kz_past&#91;end-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L113'>
          <td class='lineno'>113</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        bA&#91;end&#93; &#61; 1 - gamma&#91;end&#93;*dt &#43; beta/2 * &#40;Kz_past&#91;end&#93; &#43; Kz_past&#91;end-1&#93;&#41;  </span>
          </td>
        </tr>
        <tr id='L114'>
          <td class='lineno'>114</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        dA&#91;end&#93; &#61; A_past&#91;end&#93;</span>
          </td>
        </tr>
        <tr id='L115'>
          <td class='lineno'>115</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L116'>
          <td class='lineno'>116</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # ********** If settling speed is DOWNWARD &#40;sinking&#33;&#41; **********</span>
          </td>
        </tr>
        <tr id='L117'>
          <td class='lineno'>117</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    else</span>
          </td>
        </tr>
        <tr id='L118'>
          <td class='lineno'>118</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for i in 2:&#40;N-1&#41;</span>
          </td>
        </tr>
        <tr id='L119'>
          <td class='lineno'>119</td>
          <td class='tracecount excl'>6 &#40;2 &#37;&#41;</td>
          <td class='tracecount incl'>7 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='promotion.jl-19c22fcf9fd2f358d79c65c2fb3a734a4f85ac2c.html#L425'>/</a>
              <br />
            </div>
            <span class='code'>            aA&#91;i&#93;  &#61; -wsdtdz - beta/2 * &#40;Kz_past&#91;i-1&#93;&#43; Kz_past&#91;i&#93;&#41; </span>
          </td>
        </tr>
        <tr id='L120'>
          <td class='lineno'>120</td>
          <td class='tracecount excl'>12 &#40;3 &#37;&#41;</td>
          <td class='tracecount incl'>13 &#40;3 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='int.jl-7356bf5fd3983dd6f88aecc98dba93e2d32bfc33.html#L86'>-</a>
              <br />
            </div>
            <span class='code'>            bA&#91;i&#93;  &#61; 1 &#43; wsdtdz - gamma&#91;i&#93;*dt  &#43; beta/2*&#40;Kz_past&#91;i&#43;1&#93; &#43; 2*Kz_past&#91;i&#93; &#43; Kz_past&#91;i-1&#93;&#41; </span>
          </td>
        </tr>
        <tr id='L121'>
          <td class='lineno'>121</td>
          <td class='tracecount excl'>6 &#40;2 &#37;&#41;</td>
          <td class='tracecount incl'>7 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='float.jl-bdd47079aed1ee7b825b68a8e40cf0482ccd53e5.html#L411'>*</a>
              <br />
            </div>
            <span class='code'>            cA&#91;i&#93;  &#61; -beta/2 * &#40;Kz_past&#91;i&#93; &#43; Kz_past&#91;i&#43;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L122'>
          <td class='lineno'>122</td>
          <td class='tracecount excl'>2 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>2 &#40;1 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>            dA&#91;i&#93;  &#61; A_past&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L123'>
          <td class='lineno'>123</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end </span>
          </td>
        </tr>
        <tr id='L124'>
          <td class='lineno'>124</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>           </span>
          </td>
        </tr>
        <tr id='L125'>
          <td class='lineno'>125</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # Bottom-Boundary: no flux for scalars</span>
          </td>
        </tr>
        <tr id='L126'>
          <td class='lineno'>126</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        bA&#91;1&#93; &#61;  1 &#43; wsdtdz - &#40;gamma&#91;1&#93;*dt&#41; &#43; beta/2*&#40;Kz_past&#91;2&#93; &#43; Kz_past&#91;1&#93;&#41; </span>
          </td>
        </tr>
        <tr id='L127'>
          <td class='lineno'>127</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        cA&#91;1&#93; &#61;  -wsdtdz -beta/2 * &#40;Kz_past&#91;2&#93; &#43; Kz_past&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L128'>
          <td class='lineno'>128</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        dA&#91;1&#93; &#61;  A_past&#91;1&#93;</span>
          </td>
        </tr>
        <tr id='L129'>
          <td class='lineno'>129</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L130'>
          <td class='lineno'>130</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # Top-Boundary: no flux for scalars</span>
          </td>
        </tr>
        <tr id='L131'>
          <td class='lineno'>131</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        aA&#91;end&#93; &#61;  -beta/2 * &#40;Kz_past&#91;end&#93; &#43; Kz_past&#91;end-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L132'>
          <td class='lineno'>132</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        bA&#91;end&#93; &#61;  1 - gamma&#91;end&#93;*dt &#43; beta/2 * &#40;Kz_past&#91;end&#93; &#43; Kz_past&#91;end-1&#93;&#41; &#43; wsdtdz # okay adding this here </span>
          </td>
        </tr>
        <tr id='L133'>
          <td class='lineno'>133</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        dA&#91;end&#93; &#61; A_past&#91;end&#93;   </span>
          </td>
        </tr>
        <tr id='L134'>
          <td class='lineno'>134</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end </span>
          </td>
        </tr>
        <tr id='L135'>
          <td class='lineno'>135</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L136'>
          <td class='lineno'>136</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Solve the tridiagonal system</span>
          </td>
        </tr>
        <tr id='L137'>
          <td class='lineno'>137</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    A &#61; TDMA&#40;aA, bA, cA, dA, N&#41; </span>
          </td>
        </tr>
        <tr id='L138'>
          <td class='lineno'>138</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L139'>
          <td class='lineno'>139</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return A</span>
          </td>
        </tr>
        <tr id='L140'>
          <td class='lineno'>140</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end </span>
          </td>
        </tr>
        <tr id='L141'>
          <td class='lineno'>141</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L142'>
          <td class='lineno'>142</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L143'>
          <td class='lineno'>143</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function advance_scalar&#40;variables, discretization&#41;</span>
          </td>
        </tr>
        <tr id='L144'>
          <td class='lineno'>144</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L145'>
          <td class='lineno'>145</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Kz_past &#61; variables&#91;&quot;Kz&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L146'>
          <td class='lineno'>146</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    C_past &#61; variables&#91;&quot;C&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L147'>
          <td class='lineno'>147</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N &#61; discretization&#91;&quot;N&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L148'>
          <td class='lineno'>148</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    beta &#61; discretization&#91;&quot;beta&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L149'>
          <td class='lineno'>149</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L150'>
          <td class='lineno'>150</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    aC, bC, cC, dC &#61; initialize_abcd&#40;N&#41; </span>
          </td>
        </tr>
        <tr id='L151'>
          <td class='lineno'>151</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L152'>
          <td class='lineno'>152</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 2:&#40;N-1&#41;</span>
          </td>
        </tr>
        <tr id='L153'>
          <td class='lineno'>153</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        aC&#91;i&#93; &#61; -0.5*beta*&#40;Kz_past&#91;i&#93; &#43; Kz_past&#91;i-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L154'>
          <td class='lineno'>154</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        bC&#91;i&#93; &#61; 1 &#43; 0.5*beta*&#40;Kz_past&#91;i&#43;1&#93; &#43; 2*Kz_past&#91;i&#93; &#43; Kz_past&#91;i-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L155'>
          <td class='lineno'>155</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        cC&#91;i&#93; &#61; -0.5*beta*&#40;Kz_past&#91;i&#93; &#43; Kz_past&#91;i&#43;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L156'>
          <td class='lineno'>156</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        dC&#91;i&#93; &#61; C_past&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L157'>
          <td class='lineno'>157</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L158'>
          <td class='lineno'>158</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L159'>
          <td class='lineno'>159</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    #####  Boundary conditions</span>
          </td>
        </tr>
        <tr id='L160'>
          <td class='lineno'>160</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Bottom-Boundary: no flux for scalars</span>
          </td>
        </tr>
        <tr id='L161'>
          <td class='lineno'>161</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bC&#91;1&#93; &#61; 1 &#43; beta/2*&#40;Kz_past&#91;2&#93; &#43; Kz_past&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L162'>
          <td class='lineno'>162</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cC&#91;1&#93; &#61; -beta/2*&#40;Kz_past&#91;2&#93; &#43; Kz_past&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L163'>
          <td class='lineno'>163</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dC&#91;1&#93; &#61;  C_past&#91;1&#93; </span>
          </td>
        </tr>
        <tr id='L164'>
          <td class='lineno'>164</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L165'>
          <td class='lineno'>165</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Top-Boundary: no flux for scalars</span>
          </td>
        </tr>
        <tr id='L166'>
          <td class='lineno'>166</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    aC&#91;end&#93; &#61; -0.5*beta*&#40;Kz_past&#91;end&#93; &#43; Kz_past&#91;end-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L167'>
          <td class='lineno'>167</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bC&#91;end&#93; &#61; 1&#43;0.5*beta*&#40;Kz_past&#91;end&#93; &#43; Kz_past&#91;end-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L168'>
          <td class='lineno'>168</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dC&#91;end&#93; &#61; C_past&#91;end&#93;  </span>
          </td>
        </tr>
        <tr id='L169'>
          <td class='lineno'>169</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L170'>
          <td class='lineno'>170</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    C &#61; TDMA&#40;aC, bC, cC, dC, N&#41;</span>
          </td>
        </tr>
        <tr id='L171'>
          <td class='lineno'>171</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return C</span>
          </td>
        </tr>
        <tr id='L172'>
          <td class='lineno'>172</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L173'>
          <td class='lineno'>173</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L174'>
          <td class='lineno'>174</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L175'>
          <td class='lineno'>175</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              42 &#40;11 &#37;&#41;
              samples spent in advance_Q2
              <br />
              
              21 &#40;50 &#37;&#41; &#40;incl.&#41;
              when called from run_my_model
              <a href='run_model.jl-1578659b3b52a77292ed1339762b5233869a2b57.html#L235'>line 235</a>
              <br />
              6 &#40;14 &#37;&#41; &#40;ex.&#41;,
              21 &#40;50 &#37;&#41; &#40;incl.&#41;
              when called from advance_Q2
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L177'>line 177</a>
              <br />
            </div>
            
            <span class='code'>function advance_Q2&#40;past_var::Dict, ustar, discretization::Dict, B1&#61;B1&#41;</span>
          </td>
        </tr>
        <tr id='L176'>
          <td class='lineno'>176</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L177'>
          <td class='lineno'>177</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>21 &#40;6 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              21 &#40;100 &#37;&#41;
              samples spent calling
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L175'>advance_Q2</a>
              <br />
            </div>
            <span class='code'>    Q2_past &#61; past_var&#91;&quot;Q2&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L178'>
          <td class='lineno'>178</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    L_past &#61; past_var&#91;&quot;L&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L179'>
          <td class='lineno'>179</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Kq_past &#61; past_var&#91;&quot;Kq&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L180'>
          <td class='lineno'>180</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    nu_t_past &#61; past_var&#91;&quot;Nu&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L181'>
          <td class='lineno'>181</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    U_past &#61; past_var&#91;&quot;U&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L182'>
          <td class='lineno'>182</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Kz_past &#61; past_var&#91;&quot;Kz&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L183'>
          <td class='lineno'>183</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N_BV2_past &#61; past_var&#91;&quot;N_BV2&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L184'>
          <td class='lineno'>184</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L185'>
          <td class='lineno'>185</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    beta &#61; discretization&#91;&quot;beta&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L186'>
          <td class='lineno'>186</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dt &#61; discretization&#91;&quot;dt&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L187'>
          <td class='lineno'>187</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L188'>
          <td class='lineno'>188</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N &#61; length&#40;Q2_past&#41;</span>
          </td>
        </tr>
        <tr id='L189'>
          <td class='lineno'>189</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L41'>initialize_abcd</a>
              <br />
            </div>
            <span class='code'>    aQ2, bQ2, cQ2, dQ2 &#61; initialize_abcd&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L190'>
          <td class='lineno'>190</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L191'>
          <td class='lineno'>191</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # diss &#61; @. &#40;2 * dt *&#40;Q2_past&#91;2:end&#93;.^0.5&#41;&#41;/&#40;B1*L_past&#91;2:end&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L192'>
          <td class='lineno'>192</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>  </span>
          </td>
        </tr>
        <tr id='L193'>
          <td class='lineno'>193</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for i in 2:&#40;N-1&#41;</span>
          </td>
        </tr>
        <tr id='L194'>
          <td class='lineno'>194</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;50 &#37;&#41;
              samples spent calling
              <a href='math.jl-30541dd2205c91f388cafbf2b9cf11b8860e2d71.html#L1196'>^</a>
              <br />
              1 &#40;50 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5ebf2b15114bca269493b5820b8857cb03e2efa4.html#L587'>*</a>
              <br />
            </div>
            <span class='code'>        diss &#61; 2*dt * &#40;&#40;Q2_past&#91;i&#93;^0.5&#41;/&#40;B1*L_past&#91;i&#93;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L195'>
          <td class='lineno'>195</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5ebf2b15114bca269493b5820b8857cb03e2efa4.html#L587'>*</a>
              <br />
            </div>
            <span class='code'>        aQ2&#91;i&#93; &#61; -0.5*beta*&#40;Kq_past&#91;i&#93; &#43; Kq_past&#91;i-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L196'>
          <td class='lineno'>196</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>3 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              3 &#40;100 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5ebf2b15114bca269493b5820b8857cb03e2efa4.html#L587'>&#43;</a>
              <br />
            </div>
            <span class='code'>        bQ2&#91;i&#93; &#61; 1 &#43; 0.5*beta*&#40;Kq_past&#91;i&#43;1&#93; &#43; 2*Kq_past&#91;i&#93; &#43; Kq_past&#91;i-1&#93;&#41; &#43; diss</span>
          </td>
        </tr>
        <tr id='L197'>
          <td class='lineno'>197</td>
          <td class='tracecount excl'>2 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>4 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5ebf2b15114bca269493b5820b8857cb03e2efa4.html#L587'>*</a>
              <br />
            </div>
            <span class='code'>        cQ2&#91;i&#93; &#61; -0.5*beta*&#40;Kq_past&#91;i&#93; &#43; Kq_past&#91;i&#43;1&#93;&#41; # buoyancy production term  </span>
          </td>
        </tr>
        <tr id='L198'>
          <td class='lineno'>198</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                                                       # &#40;should be negative such that this term is</span>
          </td>
        </tr>
        <tr id='L199'>
          <td class='lineno'>199</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                                                       # adding TKE when density is unstable&#41;</span>
          </td>
        </tr>
        <tr id='L200'>
          <td class='lineno'>200</td>
          <td class='tracecount excl'>2 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>7 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              3 &#40;60 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5ebf2b15114bca269493b5820b8857cb03e2efa4.html#L587'>*</a>
              <br />
              1 &#40;20 &#37;&#41;
              samples spent calling
              <a href='intfuncs.jl-6c409dcec51ab0ffc1e00a7fc07c1da97ca6bf3a.html#L332'>literal_pow</a>
              <br />
              1 &#40;20 &#37;&#41;
              samples spent calling
              <a href='float.jl-bdd47079aed1ee7b825b68a8e40cf0482ccd53e5.html#L410'>-</a>
              <br />
            </div>
            <span class='code'>        dQ2&#91;i&#93; &#61; Q2_past&#91;i&#93; &#43; 0.25*beta*nu_t_past&#91;i&#93;*&#40;U_past&#91;i&#43;1&#93;-U_past&#91;i-1&#93;&#41;^2 - dt*Kz_past&#91;i&#93;*N_BV2_past&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L201'>
          <td class='lineno'>201</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L202'>
          <td class='lineno'>202</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L203'>
          <td class='lineno'>203</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Bottom-Boundary Condition</span>
          </td>
        </tr>
        <tr id='L204'>
          <td class='lineno'>204</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Q2bot &#61; B1^&#40;2/3&#41; * ustar^2</span>
          </td>
        </tr>
        <tr id='L205'>
          <td class='lineno'>205</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    bdryterm &#61; 0.5*beta*Kq_past&#91;1&#93;*Q2bot</span>
          </td>
        </tr>
        <tr id='L206'>
          <td class='lineno'>206</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dissipation &#61; 2 * dt *&#40;&#40;Q2_past&#91;1&#93;^0.5&#41;/&#40;B1*L_past&#91;1&#93;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L207'>
          <td class='lineno'>207</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bQ2&#91;1&#93; &#61; 1 &#43; 0.5*beta*&#40;Kq_past&#91;2&#93; &#43; Kq_past&#91;1&#93;&#41; &#43; dissipation</span>
          </td>
        </tr>
        <tr id='L208'>
          <td class='lineno'>208</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cQ2&#91;1&#93; &#61; -0.5*beta*&#40;Kq_past&#91;2&#93; &#43; Kq_past&#91;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L209'>
          <td class='lineno'>209</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dQ2&#91;1&#93; &#61; Q2_past&#91;1&#93; &#43; dt*&#40;&#40;ustar^4&#41;/nu_t_past&#91;1&#93;&#41; - dt*Kz_past&#91;1&#93;*&#40;N_BV2_past&#91;1&#93;&#41; &#43; bdryterm</span>
          </td>
        </tr>
        <tr id='L210'>
          <td class='lineno'>210</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L211'>
          <td class='lineno'>211</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Top-Boundary Condition</span>
          </td>
        </tr>
        <tr id='L212'>
          <td class='lineno'>212</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dissipation &#61; 2 * dt *&#40;&#40;Q2_past&#91;end&#93;^0.5&#41;/&#40;B1*L_past&#91;end&#93;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L213'>
          <td class='lineno'>213</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    aQ2&#91;end&#93; &#61; -0.5*beta*&#40;Kq_past&#91;end&#93; &#43; Kq_past&#91;end-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L214'>
          <td class='lineno'>214</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bQ2&#91;end&#93; &#61; 1 &#43; 0.5*beta*&#40;Kq_past&#91;end&#93; &#43; 2*Kq_past&#91;end&#93; &#43; Kq_past&#91;end-1&#93;&#41; &#43; dissipation</span>
          </td>
        </tr>
        <tr id='L215'>
          <td class='lineno'>215</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    dQ2&#91;end&#93; &#61; Q2_past&#91;end&#93; &#43; 0.25*beta*nu_t_past&#91;end&#93; * &#40;U_past&#91;end&#93; - U_past&#91;end-1&#93;&#41;^2 - 4*dt*Kz_past&#91;end&#93;*N_BV2_past&#91;end&#93;</span>
          </td>
        </tr>
        <tr id='L216'>
          <td class='lineno'>216</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L217'>
          <td class='lineno'>217</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L218'>
          <td class='lineno'>218</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Q2  &#61; TDMA&#40;aQ2, bQ2, cQ2, dQ2, N&#41; </span>
          </td>
        </tr>
        <tr id='L219'>
          <td class='lineno'>219</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Q2  &#61; add_noise_floor&#40;Q2&#41;</span>
          </td>
        </tr>
        <tr id='L220'>
          <td class='lineno'>220</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L221'>
          <td class='lineno'>221</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L222'>
          <td class='lineno'>222</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>return Q2</span>
          </td>
        </tr>
        <tr id='L223'>
          <td class='lineno'>223</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end </span>
          </td>
        </tr>
        <tr id='L224'>
          <td class='lineno'>224</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L225'>
          <td class='lineno'>225</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L226'>
          <td class='lineno'>226</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              264 &#40;69 &#37;&#41;
              samples spent in advance_Q2L
              <br />
              36 &#40;14 &#37;&#41; &#40;ex.&#41;,
              220 &#40;83 &#37;&#41; &#40;incl.&#41;
              when called from advance_Q2L
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L229'>line 229</a>
              <br />
              
              44 &#40;17 &#37;&#41; &#40;incl.&#41;
              when called from run_my_model
              <a href='run_model.jl-1578659b3b52a77292ed1339762b5233869a2b57.html#L239'>line 239</a>
              <br />
            </div>
            
            <span class='code'>function advance_Q2L&#40;past_var::Dict, ustar::Real, discretization::Dict, B1&#61;B1, kappa&#61;kappa, zb&#61;zb, E2&#61;E2, E3&#61;E3&#41;</span>
          </td>
        </tr>
        <tr id='L227'>
          <td class='lineno'>227</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L228'>
          <td class='lineno'>228</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Unpack discretization parameters</span>
          </td>
        </tr>
        <tr id='L229'>
          <td class='lineno'>229</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>220 &#40;58 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              220 &#40;100 &#37;&#41;
              samples spent calling
              <a href='advance_variables.jl-fc5a5e955d21fb490ace1dd8588a3b244b20f4c6.html#L226'>advance_Q2L</a>
              <br />
            </div>
            <span class='code'>    N &#61; discretization&#91;&quot;N&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L230'>
          <td class='lineno'>230</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    beta &#61; discretization&#91;&quot;beta&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L231'>
          <td class='lineno'>231</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    z &#61; discretization&#91;&quot;z&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L232'>
          <td class='lineno'>232</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    H &#61; discretization&#91;&quot;H&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L233'>
          <td class='lineno'>233</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dt &#61; discretization&#91;&quot;dt&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L234'>
          <td class='lineno'>234</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L235'>
          <td class='lineno'>235</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Unpack variables</span>
          </td>
        </tr>
        <tr id='L236'>
          <td class='lineno'>236</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Q2L_past &#61; past_var&#91;&quot;Q2L&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L237'>
          <td class='lineno'>237</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Q2_past &#61; past_var&#91;&quot;Q2&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L238'>
          <td class='lineno'>238</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    L_past &#61; past_var&#91;&quot;L&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L239'>
          <td class='lineno'>239</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Kq_past &#61; past_var&#91;&quot;Kq&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L240'>
          <td class='lineno'>240</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    U_past &#61; past_var&#91;&quot;U&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L241'>
          <td class='lineno'>241</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Kz_past &#61; past_var&#91;&quot;Kz&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L242'>
          <td class='lineno'>242</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    N_BV2_past &#61; past_var&#91;&quot;N_BV2&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L243'>
          <td class='lineno'>243</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    nut_past &#61; past_var&#91;&quot;Nu&quot;&#93;</span>
          </td>
        </tr>
        <tr id='L244'>
          <td class='lineno'>244</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L245'>
          <td class='lineno'>245</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L246'>
          <td class='lineno'>246</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    aQ2L, bQ2L, cQ2L, dQ2L &#61; initialize_abcd&#40;N&#41;</span>
          </td>
        </tr>
        <tr id='L247'>
          <td class='lineno'>247</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L248'>
          <td class='lineno'>248</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    for i in 2:&#40;N-1&#41;</span>
          </td>
        </tr>
        <tr id='L249'>
          <td class='lineno'>249</td>
          <td class='tracecount excl'>12 &#40;3 &#37;&#41;</td>
          <td class='tracecount incl'>14 &#40;4 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5ebf2b15114bca269493b5820b8857cb03e2efa4.html#L587'>&#43;</a>
              <br />
            </div>
            <span class='code'>        dissipation_i &#61; 2*dt*&#40;&#40;sqrt&#40;Q2_past&#91;i&#93;&#41;&#41; / &#40;B1*L_past&#91;i&#93;&#41;&#41;*&#40;1&#43;E2*&#40;L_past&#91;i&#93;/&#40;kappa*abs&#40;H-z&#91;i&#93;&#41;&#41;&#41;^2 &#43; E3*&#40;L_past&#91;i&#93;/&#40;kappa*z&#91;i&#93;&#41;&#41;^2&#41;</span>
          </td>
        </tr>
        <tr id='L250'>
          <td class='lineno'>250</td>
          <td class='tracecount excl'>3 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>4 &#40;1 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='float.jl-bdd47079aed1ee7b825b68a8e40cf0482ccd53e5.html#L409'>&#43;</a>
              <br />
            </div>
            <span class='code'>        aQ2L&#91;i&#93; &#61; -0.5*beta*&#40;Kq_past&#91;i&#93; &#43; Kq_past&#91;i-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L251'>
          <td class='lineno'>251</td>
          <td class='tracecount excl'>3 &#40;1 &#37;&#41;</td>
          <td class='tracecount incl'>7 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4 &#40;100 &#37;&#41;
              samples spent calling
              <a href='operators.jl-5ebf2b15114bca269493b5820b8857cb03e2efa4.html#L587'>&#43;</a>
              <br />
            </div>
            <span class='code'>        bQ2L&#91;i&#93; &#61; 1 &#43; 0.5*beta*&#40;Kq_past&#91;i&#43;1&#93; &#43; 2*Kq_past&#91;i&#93; &#43; Kq_past&#91;i-1&#93;&#41; &#43; dissipation_i</span>
          </td>
        </tr>
        <tr id='L252'>
          <td class='lineno'>252</td>
          <td class='tracecount excl'>8 &#40;2 &#37;&#41;</td>
          <td class='tracecount incl'>8 &#40;2 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>        cQ2L&#91;i&#93; &#61; -0.5*beta*&#40;Kq_past&#91;i&#93; &#43; Kq_past&#91;i&#43;1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L253'>
          <td class='lineno'>253</td>
          <td class='tracecount excl'>8 &#40;2 &#37;&#41;</td>
          <td class='tracecount incl'>9 &#40;2 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='int.jl-7356bf5fd3983dd6f88aecc98dba93e2d32bfc33.html#L86'>-</a>
              <br />
            </div>
            <span class='code'>        dQ2L&#91;i&#93; &#61; Q2L_past&#91;i&#93; &#43; 0.25*beta*nut_past&#91;i&#93;*E1*L_past&#91;i&#93;*&#40;U_past&#91;i&#43;1&#93;-U_past&#91;i-1&#93;&#41;^2  - 2*dt*L_past&#91;i&#93;*E1*Kz_past&#91;i&#93;*N_BV2_past&#91;i&#93;</span>
          </td>
        </tr>
        <tr id='L254'>
          <td class='lineno'>254</td>
          <td class='tracecount excl'>1 &#40;0 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;0 &#37;&#41;</td>
          <td>
            
            
            <span class='code'>    end </span>
          </td>
        </tr>
        <tr id='L255'>
          <td class='lineno'>255</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L256'>
          <td class='lineno'>256</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Bottom boundary Condition</span>
          </td>
        </tr>
        <tr id='L257'>
          <td class='lineno'>257</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    q2lbot &#61; B1^&#40;2/3&#41; * &#40;ustar^2&#41; * kappa * zb</span>
          </td>
        </tr>
        <tr id='L258'>
          <td class='lineno'>258</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bdryterm &#61; 0.5*beta*Kq_past&#91;1&#93;*q2lbot</span>
          </td>
        </tr>
        <tr id='L259'>
          <td class='lineno'>259</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dissipation &#61;  2 * dt *&#40;Q2_past&#91;1&#93;^0.5&#41;/&#40;B1*L_past&#91;1&#93;&#41;*&#40;1&#43;E2*&#40;L_past&#91;1&#93;/&#40;kappa*abs&#40;H-z&#91;1&#93;&#41;&#41;&#41;^2 </span>
          </td>
        </tr>
        <tr id='L260'>
          <td class='lineno'>260</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                                                &#43; E3*&#40;L_past&#91;1&#93;/&#40;kappa*abs&#40;z&#91;1&#93;&#41;&#41;&#41;^2&#41;</span>
          </td>
        </tr>
        <tr id='L261'>
          <td class='lineno'>261</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bQ2L&#91;1&#93; &#61; 1&#43;0.5*beta*&#40;Kq_past&#91;2&#93; &#43; Kq_past&#91;1&#93;&#41; &#43; dissipation</span>
          </td>
        </tr>
        <tr id='L262'>
          <td class='lineno'>262</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cQ2L&#91;1&#93; &#61; -0.5*beta*&#40;Kq_past&#91;2&#93; &#43; Kq_past&#91;1&#93;&#41;      </span>
          </td>
        </tr>
        <tr id='L263'>
          <td class='lineno'>263</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dQ2L&#91;1&#93; &#61; Q2L_past&#91;1&#93; &#43; dt*&#40;&#40;ustar^4&#41;/nut_past&#91;1&#93;&#41;*E1*L_past&#91;1&#93; - dt*L_past&#91;1&#93;*E1*Kz_past&#91;1&#93;*&#40;N_BV2_past&#91;1&#93;&#41; &#43; bdryterm                                      </span>
          </td>
        </tr>
        <tr id='L264'>
          <td class='lineno'>264</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L265'>
          <td class='lineno'>265</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Top boundary condition</span>
          </td>
        </tr>
        <tr id='L266'>
          <td class='lineno'>266</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dissipation &#61;  2 * dt *&#40;sqrt&#40;Q2_past&#91;end&#93;&#41;&#41;/&#40;B1*L_past&#91;end&#93;&#41;*&#40;1&#43;E2*&#40;L_past&#91;end&#93;/&#40;kappa*abs&#40;H-z&#91;end&#93;&#41;&#41;&#41;^2 </span>
          </td>
        </tr>
        <tr id='L267'>
          <td class='lineno'>267</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                                                &#43; E3*&#40;L_past&#91;end&#93;/&#40;kappa*abs&#40;z&#91;end&#93;&#41;&#41;&#41;^2&#41;</span>
          </td>
        </tr>
        <tr id='L268'>
          <td class='lineno'>268</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    aQ2L&#91;end&#93; &#61; -0.5*beta*&#40;Kq_past&#91;end&#93; &#43; Kq_past&#91;end-1&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L269'>
          <td class='lineno'>269</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bQ2L&#91;end&#93; &#61; 1&#43;0.5*beta*&#40;Kq_past&#91;end&#93; &#43; 2*Kq_past&#91;end&#93; &#43; Kq_past&#91;end-1&#93;&#41; &#43; dissipation</span>
          </td>
        </tr>
        <tr id='L270'>
          <td class='lineno'>270</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dQ2L&#91;end&#93; &#61; Q2L_past&#91;end&#93; &#43; &#40;0.25*beta*nut_past&#91;end&#93;*E1*L_past&#91;end&#93;*&#40;U_past&#91;end&#93;-U_past&#91;end-1&#93;&#41;^2&#41; - &#40;2*dt*L_past&#91;end-1&#93;*E1*Kz_past&#91;end&#93;*N_BV2_past&#91;end&#93;&#41; # Lp&#91;end-1 or end&#93;?</span>
          </td>
        </tr>
        <tr id='L271'>
          <td class='lineno'>271</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L272'>
          <td class='lineno'>272</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Q2L  &#61; TDMA&#40;aQ2L, bQ2L, cQ2L, dQ2L, N&#41;</span>
          </td>
        </tr>
        <tr id='L273'>
          <td class='lineno'>273</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Q2L &#61; abs.&#40;Q2L&#41;</span>
          </td>
        </tr>
        <tr id='L274'>
          <td class='lineno'>274</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    </span>
          </td>
        </tr>
        <tr id='L275'>
          <td class='lineno'>275</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Q2L  &#61; add_noise_floor&#40;Q2L&#41;</span>
          </td>
        </tr>
        <tr id='L276'>
          <td class='lineno'>276</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return  Q2L </span>
          </td>
        </tr>
        <tr id='L277'>
          <td class='lineno'>277</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end </span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

